---
title: "Indices a nivel subclase"
---


```{r, echo=FALSE}
library(dplyr)
library(highcharter)

indices_mensuales <- readRDS("../../01.Bases/02.Clean/02.Calculo/indices_mensuales_por_semana.rds")
canasta_alim <- readRDS("../../01.Bases/02.Clean/03.Canasta/canasta_alim.rds")

indices_mensuales <- indices_mensuales %>% arrange(coicop) %>% mutate(coicop = factor(coicop, levels = unique(coicop)))


# Gráficos ----------------------------------------------------------------


db_grafico <- indices_mensuales %>% left_join(canasta_alim %>% select(coicop, descripcion, nivel), by = "coicop") %>% 
  mutate(periodo = if_else(is.na(periodo_max), "4° semana de marzo 2021", paste(periodo_max)))
grafico <- hchart(db_grafico %>% filter(nivel==4), "line", hcaes(x = periodo, y = round(indice_mes, 2), group = descripcion)) %>%
  hc_title(text = "Evolución de indices de Alimentos") %>% 
  hc_subtitle(text = "Aperturas a nivel subclase") %>% 
  hc_xAxis(title = list(text = "Período")) %>% 
  hc_yAxis(title = list(text = "Indice"))

grafico

```